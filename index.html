
<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://img.icons8.com/plasticine/100/koshary.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>منيو مطعم المجنون</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: 'Cairo', sans-serif;
        background-color: #fff8f0; /* Creamy white background */
        background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23dcbba0' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      }
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #c084fc; /* purple-400 */
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #9333ea; /* purple-600 */
      }
      .hidden { display: none; }
      .cart-pop { animation: pop 0.3s ease-out; }
      @keyframes pop {
        0% { transform: scale(1); }
        50% { transform: scale(1.25); }
        100% { transform: scale(1); }
      }
      #category-nav.sticky {
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        border-bottom: none;
      }
      #category-container {
        scroll-padding: 0 1rem; /* Add padding when scrolling items into view */
      }
      #category-container::-webkit-scrollbar {
        display: none; /* Hide for Safari/Chrome */
      }
      #category-container {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
      }
      .active-category {
        background-color: #9333ea; /* purple-600 */
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.22.0"
  }
}
</script>
</head>
  <body class="text-gray-800">
    <!-- Header -->
    <header class="relative w-full h-64 sm:h-80 bg-cover bg-center bg-fixed" style="background-image: url('https://www2.0zz0.com/2025/10/05/21/345761937.jpg');">
        <!-- Dark overlay for better parallax feel and contrast -->
        <div class="absolute inset-0 bg-black/20"></div>
        
        <!-- Content container that holds the card -->
        <div class="relative h-full flex items-center justify-center p-4">
            <!-- The card itself -->
            <div class="bg-white/95 backdrop-blur-sm p-6 sm:p-8 rounded-2xl shadow-2xl text-center max-w-md sm:max-w-xl w-full">
                 <!-- Logo popping out of the card -->
                <img class="w-28 h-28 sm:w-32 sm:h-32 rounded-full border-4 border-white shadow-lg object-cover mx-auto -mt-20 sm:-mt-24" 
                     src="https://www2.0zz0.com/2025/10/05/00/766456769.jpg" 
                     alt="شعار مطعم المجنون">
    
                <!-- Name and Slogan -->
                <div class="mt-4">
                    <h1 class="text-3xl sm:text-5xl font-extrabold text-purple-700" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.1);">المجنون للكشرى والكريب</h1>
                    <p class="text-gray-700 mt-2 text-md sm:text-lg">طعم أصيل يجمعنا</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Category Navigation -->
    <nav id="category-nav" class="sticky top-0 bg-white z-20 py-2 border-b-2 border-gray-200 transition-shadow duration-300">
      <div id="category-container" class="container mx-auto flex items-center overflow-x-auto gap-3 px-4">
        <!-- Categories will be inserted here by JS -->
      </div>
    </nav>


    <!-- Menu -->
    <main id="menu-container" class="container mx-auto p-4">
      <!-- Menu content will be generated by JavaScript -->
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-6 mt-12">
      <div class="container mx-auto text-center">
        <h3 class="text-xl font-bold mb-4">مطعم المجنون</h3>
        <div class="space-y-4">
          <div class="flex items-center justify-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg>
            <span>حدائق اكتوبر - منطقة 390 فدان - الممشى السياحى</span>
          </div>
          <div class="flex items-center justify-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.518.76a11.024 11.024 0 006.25 6.25l.76-1.518a1 1 0 011.06-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path></svg>
            <span>
              <a href="tel:01144979054" class="hover:underline">01144979054</a> | 
              <a href="tel:01034277619" class="hover:underline">01034277619</a> | 
              <a href="tel:01227511149" class="hover:underline">01227511149</a>
            </span>
          </div>
          <div class="flex items-center justify-center gap-3">
            <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 2.83a.5.5 0 00-.43-.24h-1.54a.5.5 0 00-.49.36L12 5.83a.5.5 0 00.11.51l.88.88a.5.5 0 00.7 0l.01-.01c.2-.2.2-.52 0-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L13.1 1.5a.5.5 0 00-.36-.5H11.17a.5.5 0 00-.49.36L9.64 3.4a.5.5 0 00.1.51l.88.88a.5.5 0 00.7 0l.01-.01a.5.5 0 000-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L10.3.5a.5.5 0 00-.36-.5H8.38a.5.5 0 00-.49.36l-1.04 2.08a.5.5 0 00.1.51l.88.88a.5.5 0 00.7 0l.01-.01a.5.5 0 000-.72l-.88-.88A2.5 2.5 0 016.92.5a.5.5 0 00-.36-.5H4.92a.5.5 0 00-.49.36L3.39 2.4a.5.5 0 00.1.51l.88.88a.5.5 0 00.7 0l.01-.01c.2-.2.2-.52 0-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L4.6.5a.5.5 0 00-.36-.5H2.67a.5.5 0 00-.5.5v16a.5.5 0 00.5.5h14.67a.5.5 0 00.5-.5v-14a.5.5 0 00-.5-.5h-1.67zM17 17H3V3h1.33l-1.4 2.8a.5.5 0 00.36.7l.88.88a.5.5 0 00.7 0l.01-.01c.2-.2.2-.52 0-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L4.92 1h1.66l-1.4 2.8a.5.5 0 00.36.7l.88.88a.5.5 0 00.7 0l.01-.01a.5.5 0 000-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L8.38 1h1.79l-1.4 2.8a.5.5 0 00.36.7l.88.88a.5.5 0 00.7 0l.01-.01a.5.5 0 000-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L11.17 1h1.59l-1.4 2.8a.5.5 0 00.36.7l.88.88a.5.5 0 00.7 0l.01-.01a.5.5 0 000-.72l-.88-.88a2.5 2.5 0 01-.35-3.23L13.5 1h1.5a.5.5 0 00.43-.24l1.34-2.67a.5.5 0 00-.43-.76H3.5a.5.5 0 00-.5.5v16a.5.5 0 00.5.5h14a.5.5 0 00.5-.5v-14zM16.5 2a.5.5 0 00-.5.5v14a.5.5 0 00.5.5h1a.5.5 0 00.5-.5v-14a.5.5 0 00-.5-.5h-1z"></path></svg>
            <a href="https://wa.me/201034277619" target="_blank" rel="noopener noreferrer" class="hover:underline">01034277619 (WhatsApp)</a>
          </div>
        </div>
        <p class="mt-6 text-gray-400 text-sm">&copy; 2025. كل الحقوق محفوظة.</p>
      </div>
    </footer>


    <!-- Floating Cart Button -->
    <button id="floating-cart-button" class="fixed bottom-6 left-6 bg-purple-600 text-white rounded-full shadow-lg w-16 h-16 flex items-center justify-center z-30 hover:bg-purple-700 transition-transform transform hover:scale-110">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg>
      <span id="cart-item-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center border-2 border-purple-600 hidden">0</span>
    </button>

    <!-- Cart Sidebar -->
    <div id="cart-sidebar" class="fixed inset-0 bg-black/60 z-40 flex justify-end hidden">
      <div class="w-full max-w-md bg-white h-full flex flex-col shadow-2xl">
        <header class="p-4 bg-gray-100 border-b flex justify-between items-center">
          <h2 class="text-2xl font-bold text-gray-800">سلة التسوق</h2>
          <button id="cart-close-button" class="text-gray-600 hover:text-gray-900 text-2xl" aria-label="إغلاق">&times;</button>
        </header>
        <div id="cart-items-container" class="flex-grow overflow-y-auto p-4"></div>
        <footer class="p-4 bg-gray-100 border-t space-y-3">
            <div class="flex justify-between items-center text-gray-700"><span>المجموع الفرعي</span><span id="cart-subtotal">0.00 جنيه</span></div>
            <div class="flex justify-between items-center text-gray-700"><span>رسوم التوصيل</span><span id="cart-delivery-fee">0.00 جنيه</span></div>
            <div class="border-t pt-3 mt-3 flex justify-between items-center"><span class="text-lg font-bold">الإجمالي</span><span id="cart-total" class="text-xl font-bold text-purple-700">0.00 جنيه</span></div>
            <button id="checkout-button" class="w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">اتمام عملية الشراء</button>
        </footer>
      </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 hidden">
      <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-2xl">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">تفاصيل التوصيل</h2>
        <form id="checkout-form" noValidate>
          <div class="mb-4"><label for="name" class="block text-gray-700 mb-1">الاسم الكامل*</label><input type="text" id="name" class="w-full p-2 border rounded border-gray-300" required /><p class="text-red-500 text-sm mt-1 hidden">الاسم مطلوب</p></div>
          <div class="mb-4"><label for="phone" class="block text-gray-700 mb-1">رقم التواصل*</label><input type="tel" id="phone" class="w-full p-2 border rounded border-gray-300" required /><p class="text-red-500 text-sm mt-1 hidden">رقم التواصل مطلوب</p></div>
          <div class="mb-4"><label for="building" class="block text-gray-700 mb-1">رقم العمارة*</label><input type="text" id="building" class="w-full p-2 border rounded border-gray-300" required /><p class="text-red-500 text-sm mt-1 hidden">رقم العمارة مطلوب</p></div>
          <div class="mb-4"><label for="apartment" class="block text-gray-700 mb-1">رقم الشقة*</label><input type="text" id="apartment" class="w-full p-2 border rounded border-gray-300" required /><p class="text-red-500 text-sm mt-1 hidden">رقم الشقة مطلوب</p></div>
          <div class="mb-6"><label for="landmark" class="block text-gray-700 mb-1">علامة مميزة (اختياري)</label><input type="text" id="landmark" class="w-full p-2 border border-gray-300 rounded" /></div>
          <div class="flex justify-end gap-4">
            <button type="button" id="checkout-cancel-button" class="px-6 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300">إلغاء</button>
            <button type="submit" class="px-6 py-2 text-white bg-green-600 rounded-lg hover:bg-green-700">إرسال الطلب عبر واتساب</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Order Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 hidden">
      <div class="bg-white rounded-lg p-8 w-full max-w-sm text-center shadow-2xl">
        <div class="mx-auto bg-green-100 rounded-full h-16 w-16 flex items-center justify-center mb-4"><svg class="h-10 w-10 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg></div>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">تم إرسال طلبك!</h2>
        <p class="text-gray-600 mb-6">سيتم تحويلك إلى واتساب لإكمال الطلب. شكرًا لك!</p>
        <button id="confirmation-close-button" class="w-full px-6 py-2 text-white bg-green-600 rounded-lg hover:bg-green-700">حسنًا</button>
      </div>
    </div>
    
    <!-- Scroll to Top Button -->
    <button id="scroll-to-top-button" class="fixed bottom-6 right-6 bg-purple-600 text-white rounded-full shadow-lg w-14 h-14 flex items-center justify-center z-30 hover:bg-purple-700 transition-all duration-300 transform hover:scale-110 opacity-0 invisible">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
      </svg>
    </button>
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // --- DATA and STATE ---
        const menuData = [
          {
            title: 'الكشري',
            items: [
              { id: 1, name: 'كشري المجنون', description: 'طبق الكشري الأصيل مع صلصة مميزة ودقة وتقلية مقرمشة.', price: { regular: 25 }, image: 'https://images.unsplash.com/photo-1627308595186-e618f083a276?q=80&w=1974&auto=format&fit=crop' },
              { id: 2, name: 'سوبر المجنون', description: 'كشري تقليدي مضاف إليه قطع من الكبدة الإسكندراني.', price: { regular: 30 }, image: 'https://i.ytimg.com/vi/W6oY2v_N-x0/maxresdefault.jpg' },
              { id: 3, name: 'المجنون بمزاجة', description: 'لمسة جديدة على الكشري مع السجق الشرقي المتبل.', price: { regular: 40 }, image: 'https://i.ytimg.com/vi/bXizI0tG-24/maxresdefault.jpg' },
              { id: 4, name: 'المجنون العائلى', description: 'لمسة جديدة على الكشري مع السجق الشرقي المتبل.', price: { regular: 50 }, image: 'https://i.ytimg.com/vi/bXizI0tG-24/maxresdefault.jpg' },
            ],
          },
          {
            title: 'كشرى لحوم',
            items: [
              { id: 5, name: 'كشرى كبدة', description: 'قطع لحم طرية مطهوة ببطء مع البصل المكرمل.', price: { medium: 50, large: 65 }, image: 'https://www.justfood.tv/nawaem/admin/assets/img/21/04/22/100421.jpg' },
              { id: 6, name: 'كشرى سجق', description: 'مكرونة فرن بالصلصة مع طبقة غنية من اللحم المفروم.', price: { medium: 50, large: 65 }, image: 'https://i.ytimg.com/vi/1_G5O3a-TCM/maxresdefault.jpg' },
              { id: 7, name: 'كشرى فراخ', description: 'طاجن شهي من الدجاج والبطاطس في الفرن.', price: { medium: 55, large: 75 }, image: 'https://kitchen.sayidaty.net/uploads/small/99/990669145952e47b2d561494511d5964.jpg' },
              { id: 8, name: 'كشرى لحمة', description: 'طاجن شهي من الدجاج والبطاطس في الفرن.', price: { medium: 50, large: 65 }, image: 'https://kitchen.sayidaty.net/uploads/small/99/990669145952e47b2d561494511d5964.jpg' },
              { id: 9, name: 'كشرى شاورما فراخ', description: 'طاجن شهي من الدجاج والبطاطس في الفرن.', price: { medium: 65, large: 85 }, image: 'https://kitchen.sayidaty.net/uploads/small/99/990669145952e47b2d561494511d5964.jpg' },
              { id: 10, name: 'كشرى شاورما لحمة', description: 'طاجن شهي من الدجاج والبطاطس في الفرن.', price: { medium: 65, large: 85 }, image: 'https://kitchen.sayidaty.net/uploads/small/99/990669145952e47b2d561494511d5964.jpg' },
            ],
          },
          {
            title: 'الطواجن',
            items: [
              { id: 11, name: 'طاجن بالفرخ', description: 'قطع دجاج مقرمشة مع جبنة موتزاريلا وصوص.', price: { medium: 75, large: 50 }, image: 'https://safawacenter.com/wp-content/uploads/2023/10/%D9%83%D8%B1%D9%8A%D8%A8-%D9%83%D8%B1%D8%B3%D8%A8%D9%8A.jpg' },
              { id: 12, name: 'طاجن شاورما فراخ', description: 'بطاطس مقلية مع تومية ومخلل داخل عجينة الكريب.', price: { medium: 75, large: 90 }, image: 'https://i.ytimg.com/vi/pAj7n2d1o-c/sddefault.jpg' },
              { id: 13, name: 'طاجن باللحمة', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { medium: 45, large: 65 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
              { id: 14, name: 'طاجن شاورما لحمة', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { medium: 75, large: 90 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
              { id: 15, name: 'طاجن بالكبدة', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { medium: 45, large: 65 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
              { id: 16, name: 'طاجن بالسجق', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { medium: 50, large: 75 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
              { id: 17, name: 'كشرى + طاجن فراخ', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { regular: 75 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
              { id: 18, name: 'كشرى + طاجن لحمة', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { regular: 70 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
              { id: 19, name: 'كشرى + طاجن كبدة', description: 'كريب حلو محشو بشوكولاتة النوتيلا وشرائح الموز.', price: { regular: 70 }, image: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop' },
            ],
          },
          {
            title: 'طواجن لحوم',
            items: [
                { id: 20, name: 'طاجن مكرونة باللحمة والموتزاريلا', description: 'جرعة إضافية من صلصة الكشري المميزة.', price: { medium: 60, large: 80 }, image: 'https://www.cairo24.com/Upload/libfiles/1004/8/825.jpg' },
                { id: 21, name: 'طاجن مكرونة بالفراخ والموتزاريلا', description: 'خل وثوم لمذاق حامضي ومنعش.', price: { medium: 65, large: 90 }, image: 'https://i.ytimg.com/vi/r6_Cg8iGz2E/maxresdefault.jpg' },
                { id: 22, name: 'طاجن مكرونة بالكبدة والموتزاريلا', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 60, large: 80 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 23, name: 'طاجن مكرونة بالسجق والموتزاريلا', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 65, large: 90 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'مكرونة',
            items: [
                { id: 24, name: 'مكرونة بشاميل', description: 'جرعة إضافية من صلصة الكشري المميزة.', price: { medium: 30, large: 60 }, image: 'https://www.cairo24.com/Upload/libfiles/1004/8/825.jpg' },
                { id: 25, name: 'مكرونة نجرسكو فراخ', description: 'خل وثوم لمذاق حامضي ومنعش.', price: { medium: 80, large: 100 }, image: 'https://i.ytimg.com/vi/r6_Cg8iGz2E/maxresdefault.jpg' },
                { id: 26, name: 'نجرسكو سوسيس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 80, large: 100 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 27, name: 'اسباجتى كبدة اسكندرانى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 45, large: 60 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 28, name: 'اسباجتى سجق مشوى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 50, large: 65 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 29, name: 'اسباجتى بالفراخ', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 50, large: 65 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 30, name: 'اسباجتى باللحمة', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 45, large: 60 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 31, name: 'اسباجتى بالصلصة والصوص', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 35, large: 45 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 32, name: 'اسباجتى سوسيس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 50, large: 65 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'الإضافات',
            items: [
                { id: 33, name: 'عيش توست', description: 'جرعة إضافية من صلصة الكشري المميزة.', price: { regular: 10 }, image: 'https://www.cairo24.com/Upload/libfiles/1004/8/825.jpg' },
                { id: 34, name: 'خيار', description: 'خل وثوم لمذاق حامضي ومنعش.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/r6_Cg8iGz2E/maxresdefault.jpg' },
                { id: 35, name: 'طماطم شطة المحنون', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 36, name: 'طماطم دقة المجنون', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 37, name: 'سلطة المجنون', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 38, name: 'احلة صلصة', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 39, name: 'كهرمان عدس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 40, name: 'ورد تقيلة', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 15 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 41, name: 'حمص', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 42, name: 'كانز', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 17 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 43, name: 'مياة معدنية', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 7 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'كريب فراخ',
            items: [
                { id: 44, name: 'شاورما فراخ', description: 'جرعة إضافية من صلصة الكشري المميزة.', price: { regular: 80 }, image: 'https://www.cairo24.com/Upload/libfiles/1004/8/825.jpg' },
                { id: 45, name: 'فاهيتا فراخ', description: 'خل وثوم لمذاق حامضي ومنعش.', price: { regular: 85 }, image: 'https://i.ytimg.com/vi/r6_Cg8iGz2E/maxresdefault.jpg' },
                { id: 46, name: 'شيش طاووق', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 80 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 47, name: 'زنجر حار', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 80 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 48, name: 'بانية', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 49, name: 'سوبر كرانش بارد', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 75 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 50, name: 'تشكن ميكسيكان', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 80 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 51, name: 'ميكس فراخ', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 105 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 52, name: 'تشكن رول', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 80 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'كريب بطاطس',
            items: [
                { id: 53, name: 'بطاطس', description: 'جرعة إضافية من صلصة الكشري المميزة.', price: { regular: 55 }, image: 'https://www.cairo24.com/Upload/libfiles/1004/8/825.jpg' },
                { id: 54, name: 'بطاطس مكس جبن', description: 'خل وثوم لمذاق حامضي ومنعش.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/r6_Cg8iGz2E/maxresdefault.jpg' },
            ],
          },
          {
            title: 'كريب الجبن',
            items: [
                { id: 55, name: 'مكس جبن', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 60 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 56, name: 'مارجريتا', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 40 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'كريب الحلو',
            items: [
                { id: 57, name: 'نوتيلا سادة', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 40 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 58, name: 'نوتيلا موز', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 60 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'كريب اللحوم',
            items: [
                { id: 59, name: 'شاورما لحم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 85 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 60, name: 'فاهيتا لحم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 90 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 61, name: 'برجر لحم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 62, name: 'سوسيس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 63, name: 'هوت دوج', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 64, name: 'كفتة لحم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 65, name: 'سجق مشوى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 70 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 66, name: 'كبدة اسكندرانى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 65 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'حواوشى',
            items: [
                { id: 67, name: 'حواوشى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 30 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 68, name: 'حواوشى موتزاريلا', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 45 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 69, name: 'حواوشى + لحمة + سجق', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 55 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 70, name: 'طحينة', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 10 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'سندوتشات اللحمة',
            items: [
                { id: 71, name: 'شاورما لحم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 40, large: 55 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 72, name: 'فاهيتا لحم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 45, large: 60 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 73, name: 'برجر سادة', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 25, large: 35 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 74, name: 'برجر بيض', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 30, large: 40 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 75, name: 'برجر ميكس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 40, large: 55 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 76, name: 'هوت دوج', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 25, large: 35 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 77, name: 'كبدة اسكندرانى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 20, large: 30 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 78, name: 'سجق مشوى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 20, large: 30 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 79, name: 'سوسيس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 25, large: 35 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'سندوتشات البطاطس',
            items: [
                { id: 80, name: 'بطاطس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 20, large: 30 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 81, name: 'طبق بطاطس ميكس جبن', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 40, large: 45 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 82, name: 'بطاطس موتزاريلا', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 30, large: 45 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 83, name: 'باكت بطاطس', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 30, large: 40 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'سندوتشات الفراخ',
            items: [
                { id: 84, name: 'شاورما فراخ', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 35, large: 50 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 85, name: 'فاهيتا فراخ', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 40, large: 55 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 86, name: 'شيش طاووق', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 35, large: 45 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 87, name: 'بانية', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 30, large: 40 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 88, name: 'كريسبى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 30, large: 40 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 89, name: 'زنجر', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 40, large: 50 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 90, name: 'زنجر سوبريم', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 50, large: 60 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 91, name: 'تشكين رول', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { medium: 30, large: 45 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
          {
            title: 'الحلو',
            items: [
                { id: 92, name: 'ارز بلبن عادى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 15 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 93, name: 'ارز بلبن فرن', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 20 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 94, name: 'كنافة نابلسية', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 20 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 95, name: 'جيلى', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 20 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 96, name: 'كريم كراميل', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 20 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
                { id: 97, name: 'ام على', description: 'لمسة حارة وغنية لمحبي النكهات القوية.', price: { regular: 25 }, image: 'https://i.ytimg.com/vi/S7-vGeUIK-A/maxresdefault.jpg' },
            ],
          },
        ];
        let cart = [];
        const DELIVERY_FEE = 15;

        // --- DOM Elements ---
        const getEl = (id) => document.getElementById(id);
        const menuContainer = getEl('menu-container');
        const floatingCartButton = getEl('floating-cart-button');
        const cartItemCountSpan = getEl('cart-item-count');
        const cartSidebar = getEl('cart-sidebar');
        const cartCloseButton = getEl('cart-close-button');
        const cartItemsContainer = getEl('cart-items-container');
        const cartSubtotalSpan = getEl('cart-subtotal');
        const cartDeliveryFeeSpan = getEl('cart-delivery-fee');
        const cartTotalSpan = getEl('cart-total');
        const checkoutButton = getEl('checkout-button');
        const checkoutModal = getEl('checkout-modal');
        const checkoutForm = getEl('checkout-form');
        const checkoutCancelButton = getEl('checkout-cancel-button');
        const confirmationModal = getEl('confirmation-modal');
        const confirmationCloseButton = getEl('confirmation-close-button');
        const categoryContainer = getEl('category-container');
        const scrollToTopButton = getEl('scroll-to-top-button');

        // --- RENDER FUNCTIONS ---
        const renderPriceAndButton = (item) => {
          const priceKeys = Object.keys(item.price);
          const sizeMap = { small: 'صغير', medium: 'وسط', large: 'كبير', regular: 'عادي' };

          if (priceKeys.length > 1) {
            // Multi-price item
            return `
              <div class="mt-4 flex flex-col items-start gap-2 w-full">
                <div class="w-full">
                  ${priceKeys.map((size, index) => `
                    <label class="w-full flex justify-between items-center gap-2 cursor-pointer p-2 rounded hover:bg-gray-100">
                      <span class="text-gray-700">${sizeMap[size]}: ${item.price[size]} ج</span>
                      <input type="radio" name="size-${item.id}" value="${size}" ${index === 0 ? 'checked' : ''} class="form-radio text-yellow-500 focus:ring-yellow-400" />
                    </label>
                  `).join('')}
                </div>
                <button data-item-id="${item.id}" class="add-to-cart-btn w-full bg-yellow-500 text-gray-800 font-bold py-2 px-3 rounded-lg hover:bg-yellow-600 transition-all duration-300 transform hover:scale-105">أضف للسلة</button>
              </div>
            `;
          } else {
            // Single-price item
            const size = priceKeys[0];
            return `
              <div class="mt-4 flex flex-row items-center justify-between gap-4 w-full">
                <p class="text-lg font-bold text-gray-900 flex-shrink-0">${item.price[size]} جنيه</p>
                <button data-item-id="${item.id}" data-size="${size}" class="add-to-cart-btn bg-yellow-500 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors flex-shrink-0">أضف للسلة</button>
              </div>
            `;
          }
        };

        const renderMenu = () => {
          menuContainer.innerHTML = menuData.map(category => `
            <section id="category-${category.title.replace(/\s+/g, '-')}" class="mb-12">
              <h2 class="text-3xl font-bold text-purple-800 border-b-4 border-purple-200 pb-2 mb-6">${category.title}</h2>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                ${category.items.map(item => `
                  <div class="bg-white rounded-lg shadow-md flex flex-row items-center p-4 gap-4 transition-shadow hover:shadow-lg">
                    <img src="https://www2.0zz0.com/2025/10/05/00/766456769.jpg" alt="${item.name}" class="w-24 h-24 object-cover rounded-md flex-shrink-0">
                    <div class="flex flex-col flex-grow">
                        <div class="flex-grow">
                            <h3 class="text-xl font-bold text-gray-800">${item.name}</h3>
                            <p class="text-gray-600 text-sm mt-1">${item.description}</p>
                        </div>
                        ${renderPriceAndButton(item)}
                    </div>
                  </div>
                `).join('')}
              </div>
            </section>
          `).join('');
        };

        const renderCategories = () => {
            const categories = menuData.map(c => c.title);
            const allCategories = ['الكل', ...categories];
            categoryContainer.innerHTML = allCategories.map(title => `
                <button data-category-title="${title}" class="category-btn flex-shrink-0 whitespace-nowrap px-4 py-2 rounded-full text-sm font-semibold transition-all duration-300 ${title === 'الكل' ? 'active-category' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                    ${title}
                </button>
            `).join('');
        };
        
        const updateCartView = () => {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            const isCartEmpty = cart.length === 0;
            const deliveryFee = isCartEmpty ? 0 : DELIVERY_FEE;
            const totalPrice = subtotal + deliveryFee;

            cartItemCountSpan.textContent = totalItems;
            cartItemCountSpan.classList.toggle('hidden', totalItems === 0);
            
            cartSubtotalSpan.textContent = `${subtotal.toFixed(2)} جنيه`;
            cartDeliveryFeeSpan.textContent = `${deliveryFee.toFixed(2)} جنيه`;
            cartTotalSpan.textContent = `${totalPrice.toFixed(2)} جنيه`;
            checkoutButton.disabled = isCartEmpty;

            if (isCartEmpty) {
                cartItemsContainer.innerHTML = `<p class="text-gray-500 text-lg text-center mt-10">سلتك فارغة.</p>`;
            } else {
                const sizeMap = { small: ' (صغير)', medium: ' (وسط)', large: ' (كبير)', regular: '' };
                cartItemsContainer.innerHTML = cart.map(item => `
                    <div class="flex items-center justify-between border-b pb-3 mb-3">
                        <div>
                            <h3 class="font-bold">${item.name}${sizeMap[item.size] || ''}</h3>
                            <p class="text-gray-600">${item.price} جنيه</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <button data-item-id="${item.id}" data-size="${item.size}" data-change="-1" class="update-quantity-btn w-8 h-8 rounded-full border bg-gray-200 font-bold">-</button>
                            <span>${item.quantity}</span>
                            <button data-item-id="${item.id}" data-size="${item.size}" data-change="1" class="update-quantity-btn w-8 h-8 rounded-full border bg-gray-200 font-bold">+</button>
                        </div>
                    </div>
                  `).join('');
            }
        };

        // --- CORE LOGIC FUNCTIONS ---
        const requiredFields = ['name', 'phone', 'building', 'apartment'];
        
        const findMenuItem = (id) => {
            for (const category of menuData) {
                const item = category.items.find(i => i.id === id);
                if (item) return item;
            }
            return null;
        };

        const handleAddToCart = (itemId, size) => {
            const itemData = findMenuItem(itemId);
            if (!itemData) return;
            const price = itemData.price[size];
            if (typeof price !== 'number') return;

            const existingItem = cart.find(cartItem => cartItem.id === itemId && cartItem.size === size);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ id: itemId, name: itemData.name, price, quantity: 1, size });
            }
            updateCartView();
        };

        const handleUpdateQuantity = (itemId, size, change) => {
            const itemIndex = cart.findIndex(cartItem => cartItem.id === itemId && cartItem.size === size);
            if (itemIndex === -1) return;
            cart[itemIndex].quantity += change;
            if (cart[itemIndex].quantity <= 0) {
                cart.splice(itemIndex, 1);
            }
            updateCartView();
        };
        
        const handlePlaceOrder = () => {
            let isValid = true;
            requiredFields.forEach(id => {
                const input = getEl(id);
                const errorP = input.nextElementSibling;
                if (!input.value.trim()) {
                    isValid = false;
                    input.classList.add('border-red-500');
                    errorP.classList.remove('hidden');
                } else {
                    input.classList.remove('border-red-500');
                    errorP.classList.add('hidden');
                }
            });

            if (!isValid) return;

            const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            const total = subtotal + DELIVERY_FEE;
            
            let orderMessage = `*طلب جديد من مطعم المجنون*\n\n`;
            orderMessage += `*العميل:* ${getEl('name').value}\n`;
            orderMessage += `*رقم التواصل:* ${getEl('phone').value}\n`;
            orderMessage += `*العنوان:* عمارة ${getEl('building').value}, شقة ${getEl('apartment').value}\n`;
            const landmarkValue = getEl('landmark').value;
            if (landmarkValue) orderMessage += `*علامة مميزة:* ${landmarkValue}\n`;
            orderMessage += `\n*الطلبات:*\n`;
            const sizeMap = { small: ' (صغير)', medium: ' (وسط)', large: ' (كبير)', regular: '' };
            cart.forEach(item => {
                orderMessage += `- ${item.name}${sizeMap[item.size] || ''} (الكمية: ${item.quantity}) - ${item.price * item.quantity} جنيه\n`;
            });
            
            orderMessage += `\n*المجموع الفرعي: ${subtotal.toFixed(2)} جنيه*`;
            orderMessage += `\n*رسوم التوصيل: ${DELIVERY_FEE.toFixed(2)} جنيه*`;
            orderMessage += `\n*الإجمالي النهائي: ${total.toFixed(2)} جنيه*`;

            const whatsappNumber = "201030566078";
            const encodedMessage = encodeURIComponent(orderMessage);
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

            checkoutModal.classList.add('hidden');
            confirmationModal.classList.remove('hidden');
            window.open(whatsappUrl, '_blank');
        };

        const resetOrder = () => {
            cart = [];
            updateCartView();
            checkoutForm.reset();
            requiredFields.forEach(id => {
                const input = getEl(id);
                input.classList.remove('border-red-500');
                input.nextElementSibling.classList.add('hidden');
            });
        };
        
        // --- EVENT LISTENERS ---
        menuContainer.addEventListener('click', (e) => {
            const button = e.target.closest('.add-to-cart-btn');
            if (!button || button.disabled) return;
            
            const itemId = parseInt(button.dataset.itemId);
            let selectedSize = button.dataset.size;
            if (!selectedSize) {
                const card = button.closest('.flex-col');
                selectedSize = card.querySelector(`input[name="size-${itemId}"]:checked`).value;
            }
            
            handleAddToCart(itemId, selectedSize);
            
            const originalText = button.innerHTML;
            button.disabled = true;
            button.classList.replace('bg-yellow-500', 'bg-green-600');
            button.innerHTML = `✓ تم`;
            floatingCartButton.classList.add('cart-pop');
            floatingCartButton.addEventListener('animationend', () => floatingCartButton.classList.remove('cart-pop'), { once: true });

            setTimeout(() => {
                button.disabled = false;
                button.classList.replace('bg-green-600', 'bg-yellow-500');
                button.innerHTML = originalText;
            }, 1500);
        });

        cartItemsContainer.addEventListener('click', (e) => {
            const button = e.target.closest('.update-quantity-btn');
            if (button) {
                const { itemId, size, change } = button.dataset;
                handleUpdateQuantity(parseInt(itemId), size, parseInt(change));
            }
        });

        categoryContainer.addEventListener('click', (e) => {
            const button = e.target.closest('.category-btn');
            if (!button) return;

            // Scroll the clicked button into view on mobile/overflow
            button.scrollIntoView({
                behavior: 'smooth',
                inline: 'center',
                block: 'nearest'
            });

            // Update active button style
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active-category');
                btn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
            });
            button.classList.add('active-category');
            button.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');

            // Filter logic
            const categoryTitle = button.dataset.categoryTitle;
            const allSections = document.querySelectorAll('#menu-container > section');

            allSections.forEach(section => {
                if (categoryTitle === 'الكل') {
                    section.classList.remove('hidden');
                } else {
                    const sectionId = `category-${categoryTitle.replace(/\s+/g, '-')}`;
                    if (section.id === sectionId) {
                        section.classList.remove('hidden');
                    } else {
                        section.classList.add('hidden');
                    }
                }
            });
        });
        
        // --- Modal and Sidebar toggles ---
        floatingCartButton.addEventListener('click', () => cartSidebar.classList.remove('hidden'));
        cartCloseButton.addEventListener('click', () => cartSidebar.classList.add('hidden'));
        cartSidebar.addEventListener('click', (e) => { if(e.target === cartSidebar) cartSidebar.classList.add('hidden'); });
        
        checkoutButton.addEventListener('click', () => { cartSidebar.classList.add('hidden'); checkoutModal.classList.remove('hidden'); });
        checkoutForm.addEventListener('submit', (e) => { e.preventDefault(); handlePlaceOrder(); });
        checkoutCancelButton.addEventListener('click', () => checkoutModal.classList.add('hidden'));
        checkoutModal.addEventListener('click', (e) => { if(e.target === checkoutModal) checkoutModal.classList.add('hidden'); });
        
        confirmationCloseButton.addEventListener('click', () => {
          confirmationModal.classList.add('hidden');
          resetOrder();
        });

        // --- Scroll to top button ---
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollToTopButton.classList.remove('opacity-0', 'invisible');
                scrollToTopButton.classList.add('opacity-100', 'visible');
            } else {
                scrollToTopButton.classList.remove('opacity-100', 'visible');
                scrollToTopButton.classList.add('opacity-0', 'invisible');
            }
        });
        scrollToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // --- INITIALIZATION ---
        renderMenu();
        renderCategories();
        updateCartView();
      });
    </script>
  </body>
</html>




